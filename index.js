var data = { "results": [{ "gender": "male", "name": { "title": "Mr", "first": "Mons", "last": "Koppang" }, "location": { "street": { "number": 9419, "name": "Treschows gate" }, "city": "Vestre Jakobselv", "state": "Finnmark - Finnmárku", "country": "Norway", "postcode": "1556", "coordinates": { "latitude": "50.3480", "longitude": "-134.4394" }, "timezone": { "offset": "-8:00", "description": "Pacific Time (US & Canada)" } }, "email": "mons.koppang@example.com", "login": { "uuid": "a72fee31-1ad0-4f8a-b4c3-574169aa4f1d", "username": "silverduck421", "password": "dreaming", "salt": "hOZa9HPE", "md5": "696c77ad27c93eae187b08bbe94f4b00", "sha1": "517f34120facb77bc60ba7cf7d6760b8ec888d42", "sha256": "b726b4f308bbc164f6480e406c429f856e0a48bd954ad5289700eceacf1bac41" }, "dob": { "date": "1969-03-23T07:56:11.034Z", "age": 52 }, "registered": { "date": "2007-08-24T11:15:20.948Z", "age": 14 }, "phone": "56663908", "cell": "43547083", "id": { "name": "FN", "value": "23036932732" }, "picture": { "large": "https://randomuser.me/api/portraits/men/7.jpg", "medium": "https://randomuser.me/api/portraits/med/men/7.jpg", "thumbnail": "https://randomuser.me/api/portraits/thumb/men/7.jpg" }, "nat": "NO" }, { "gender": "male", "name": { "title": "Mr", "first": "Bradley", "last": "Terry" }, "location": { "street": { "number": 6526, "name": "Lakeshore Rd" }, "city": "Berkeley", "state": "Maryland", "country": "United States", "postcode": 18483, "coordinates": { "latitude": "-69.4668", "longitude": "-42.5106" }, "timezone": { "offset": "+11:00", "description": "Magadan, Solomon Islands, New Caledonia" } }, "email": "bradley.terry@example.com", "login": { "uuid": "97b1d452-f61e-4fa6-9613-02c8da2df5eb", "username": "yellowfrog915", "password": "sinbad", "salt": "pajWFZQi", "md5": "ff28d2151e2af59ba85f52696efa6b1b", "sha1": "96512e3c876436cfca9c88c2fd3c91123f828e41", "sha256": "a9c057ee753b0c95d80b442945ba449226824eaf6e94f1bce5f6c17b212aa90a" }, "dob": { "date": "1984-11-28T17:10:40.655Z", "age": 37 }, "registered": { "date": "2019-04-17T21:03:25.055Z", "age": 2 }, "phone": "(891)-649-5787", "cell": "(025)-025-1012", "id": { "name": "SSN", "value": "835-27-9781" }, "picture": { "large": "https://randomuser.me/api/portraits/men/72.jpg", "medium": "https://randomuser.me/api/portraits/med/men/72.jpg", "thumbnail": "https://randomuser.me/api/portraits/thumb/men/72.jpg" }, "nat": "US" }, { "gender": "male", "name": { "title": "Monsieur", "first": "Jason", "last": "Giraud" }, "location": { "street": { "number": 6725, "name": "Rue de L'Abbé-De-L'Épée" }, "city": "Reisiswil", "state": "Genève", "country": "Switzerland", "postcode": 6528, "coordinates": { "latitude": "85.4690", "longitude": "80.8868" }, "timezone": { "offset": "+9:30", "description": "Adelaide, Darwin" } }, "email": "jason.giraud@example.com", "login": { "uuid": "de2a7f9c-dc04-4813-8212-3d594bfbd135", "username": "silverbear107", "password": "wave", "salt": "TkssFxtq", "md5": "f9d01282422da37aaed0bfa8da399cca", "sha1": "984943900eae592823b413ea7888bbc7e458b352", "sha256": "91b9b378e90632a2eb87739b8d29a225888a659ffe89ddf767399386a4818aa4" }, "dob": { "date": "1994-01-16T14:30:38.128Z", "age": 27 }, "registered": { "date": "2017-08-03T16:06:44.229Z", "age": 4 }, "phone": "078 759 56 37", "cell": "077 287 68 91", "id": { "name": "AVS", "value": "756.2801.5186.92" }, "picture": { "large": "https://randomuser.me/api/portraits/men/0.jpg", "medium": "https://randomuser.me/api/portraits/med/men/0.jpg", "thumbnail": "https://randomuser.me/api/portraits/thumb/men/0.jpg" }, "nat": "CH" }, { "gender": "female", "name": { "title": "Ms", "first": "Vilma", "last": "Neva" }, "location": { "street": { "number": 5076, "name": "Pyynikintie" }, "city": "Pello", "state": "Central Ostrobothnia", "country": "Finland", "postcode": 53651, "coordinates": { "latitude": "-8.1174", "longitude": "-38.0783" }, "timezone": { "offset": "+9:00", "description": "Tokyo, Seoul, Osaka, Sapporo, Yakutsk" } }, "email": "vilma.neva@example.com", "login": { "uuid": "ea8b4ab2-4486-454f-800e-e09bc8f8a5b7", "username": "angryelephant754", "password": "2345", "salt": "Ukwds7N4", "md5": "e8378afc8aa4e9cab4cc597b3c3a1bf7", "sha1": "ac4c2ec6a7d5c322b6c6bf8c92370ff94c7890ed", "sha256": "99d9fb3cba5dfa2c6c280d0a2e3988109990d6d39913bf0e32ff0f89ed69888b" }, "dob": { "date": "1950-03-02T07:35:59.630Z", "age": 71 }, "registered": { "date": "2010-01-28T08:36:54.505Z", "age": 11 }, "phone": "05-466-698", "cell": "042-706-76-99", "id": { "name": "HETU", "value": "NaNNA242undefined" }, "picture": { "large": "https://randomuser.me/api/portraits/women/58.jpg", "medium": "https://randomuser.me/api/portraits/med/women/58.jpg", "thumbnail": "https://randomuser.me/api/portraits/thumb/women/58.jpg" }, "nat": "FI" }, { "gender": "female", "name": { "title": "Madame", "first": "Seraina", "last": "Gauthier" }, "location": { "street": { "number": 7821, "name": "Rue Abel-Gance" }, "city": "Erlinsbach (So)", "state": "Schaffhausen", "country": "Switzerland", "postcode": 1779, "coordinates": { "latitude": "-49.2616", "longitude": "126.8131" }, "timezone": { "offset": "+8:00", "description": "Beijing, Perth, Singapore, Hong Kong" } }, "email": "seraina.gauthier@example.com", "login": { "uuid": "baee23d1-192e-49f3-adf9-ee8a907c2504", "username": "silverwolf739", "password": "minime", "salt": "7wdzhPoU", "md5": "ef9c7b800191374f549c6280b5170c96", "sha1": "7e16cd43529ae9255bf34ec23283856b7b0de45a", "sha256": "c55f448c2636df65cbf453706ef44cea6b2191c54e63f52a090ebca6f150b366" }, "dob": { "date": "1993-12-15T12:10:52.369Z", "age": 28 }, "registered": { "date": "2002-08-04T18:52:58.939Z", "age": 19 }, "phone": "078 498 82 36", "cell": "077 683 73 43", "id": { "name": "AVS", "value": "756.9041.9571.87" }, "picture": { "large": "https://randomuser.me/api/portraits/women/46.jpg", "medium": "https://randomuser.me/api/portraits/med/women/46.jpg", "thumbnail": "https://randomuser.me/api/portraits/thumb/women/46.jpg" }, "nat": "CH" }, { "gender": "female", "name": { "title": "Ms", "first": "Alex", "last": "Scott" }, "location": { "street": { "number": 5127, "name": "New Street" }, "city": "Loughrea", "state": "Monaghan", "country": "Ireland", "postcode": 67868, "coordinates": { "latitude": "80.2392", "longitude": "48.8377" }, "timezone": { "offset": "-2:00", "description": "Mid-Atlantic" } }, "email": "alex.scott@example.com", "login": { "uuid": "e003b179-76aa-49ed-8c0a-caee37538d57", "username": "greenostrich269", "password": "miao", "salt": "lMElhnxU", "md5": "86b39dab640b4518d6982406786867dd", "sha1": "2349d07f33213bacd8d0dbd868b3408fe4796add", "sha256": "352b12b5f58de018a5ac0deadced6a87224ba1f9329cd4a41e22bf61d672c0b4" }, "dob": { "date": "1962-09-27T06:47:42.193Z", "age": 59 }, "registered": { "date": "2006-02-09T12:12:40.024Z", "age": 15 }, "phone": "031-944-7177", "cell": "081-085-1281", "id": { "name": "PPS", "value": "8840611T" }, "picture": { "large": "https://randomuser.me/api/portraits/women/32.jpg", "medium": "https://randomuser.me/api/portraits/med/women/32.jpg", "thumbnail": "https://randomuser.me/api/portraits/thumb/women/32.jpg" }, "nat": "IE" }, { "gender": "male", "name": { "title": "Mr", "first": "كيان", "last": "کریمی" }, "location": { "street": { "number": 9243, "name": "شهید استاد حسن بنا" }, "city": "یزد", "state": "آذربایجان غربی", "country": "Iran", "postcode": 46312, "coordinates": { "latitude": "62.0461", "longitude": "101.5533" }, "timezone": { "offset": "-12:00", "description": "Eniwetok, Kwajalein" } }, "email": "kyn.khrymy@example.com", "login": { "uuid": "549be516-1a3c-49ce-be07-d1b7fdc35a8a", "username": "ticklishsnake965", "password": "iiiiiii", "salt": "T2LLyOgQ", "md5": "7d0533f0a57b965cb5fa7818a6748cdd", "sha1": "a42922a93992472981a0f65d00bedd78dac82f34", "sha256": "fe12c39bb3c8b0c0295757325e31afd49e2d2cc3e2dbddcb4d6c8959ea19dbcb" }, "dob": { "date": "1998-01-08T22:09:27.764Z", "age": 23 }, "registered": { "date": "2017-07-27T01:24:07.105Z", "age": 4 }, "phone": "066-20758260", "cell": "0945-758-1206", "id": { "name": "", "value": null }, "picture": { "large": "https://randomuser.me/api/portraits/men/21.jpg", "medium": "https://randomuser.me/api/portraits/med/men/21.jpg", "thumbnail": "https://randomuser.me/api/portraits/thumb/men/21.jpg" }, "nat": "IR" }, { "gender": "male", "name": { "title": "Mr", "first": "Gillis", "last": "Van Diejen" }, "location": { "street": { "number": 9369, "name": "Johan Roemerhof" }, "city": "Leermens", "state": "Noord-Holland", "country": "Netherlands", "postcode": 55607, "coordinates": { "latitude": "65.3784", "longitude": "-54.1453" }, "timezone": { "offset": "-3:00", "description": "Brazil, Buenos Aires, Georgetown" } }, "email": "gillis.vandiejen@example.com", "login": { "uuid": "b575f062-e8b2-4db9-b0dd-6879ba3a7313", "username": "biggorilla472", "password": "glory", "salt": "2VX26hvn", "md5": "2e836cc0e6b9dd29b8988f4f1f88a923", "sha1": "5ce22b997bf333aa586ad8fa070a16993290e015", "sha256": "e118ac96c44039bcee9b102fbda28f779ef96ce94f36d3f4fcb17279a518bf53" }, "dob": { "date": "1954-07-13T21:33:06.017Z", "age": 67 }, "registered": { "date": "2009-09-05T01:38:55.777Z", "age": 12 }, "phone": "(570)-076-3110", "cell": "(965)-506-0170", "id": { "name": "BSN", "value": "73365159" }, "picture": { "large": "https://randomuser.me/api/portraits/men/45.jpg", "medium": "https://randomuser.me/api/portraits/med/men/45.jpg", "thumbnail": "https://randomuser.me/api/portraits/thumb/men/45.jpg" }, "nat": "NL" }, { "gender": "male", "name": { "title": "Monsieur", "first": "Grégory", "last": "Perrin" }, "location": { "street": { "number": 9598, "name": "Rue Bony" }, "city": "Éclépens", "state": "Zug", "country": "Switzerland", "postcode": 8808, "coordinates": { "latitude": "-22.0624", "longitude": "92.7172" }, "timezone": { "offset": "+4:00", "description": "Abu Dhabi, Muscat, Baku, Tbilisi" } }, "email": "gregory.perrin@example.com", "login": { "uuid": "95a35355-e77c-42bb-8d92-4d1dd70a23a6", "username": "purplesnake596", "password": "goldfish", "salt": "xielQ9Rw", "md5": "d410af255a20dd9df4cd5c477be7d46e", "sha1": "dbe1331a1b1d343ba79c6cddf1b2c044006dd6c5", "sha256": "e7215a946ffd41e731f056be40a0ef1ac321990f5d40fee41d20313c35d18661" }, "dob": { "date": "1978-03-22T14:39:21.790Z", "age": 43 }, "registered": { "date": "2010-06-14T15:09:26.600Z", "age": 11 }, "phone": "078 430 66 71", "cell": "075 797 09 89", "id": { "name": "AVS", "value": "756.1396.8899.50" }, "picture": { "large": "https://randomuser.me/api/portraits/men/52.jpg", "medium": "https://randomuser.me/api/portraits/med/men/52.jpg", "thumbnail": "https://randomuser.me/api/portraits/thumb/men/52.jpg" }, "nat": "CH" }, { "gender": "female", "name": { "title": "Mrs", "first": "Ellen", "last": "Bishop" }, "location": { "street": { "number": 6339, "name": "Saddle Dr" }, "city": "Wollongong", "state": "South Australia", "country": "Australia", "postcode": 8501, "coordinates": { "latitude": "30.5568", "longitude": "135.6345" }, "timezone": { "offset": "+9:30", "description": "Adelaide, Darwin" } }, "email": "ellen.bishop@example.com", "login": { "uuid": "0e6f06bd-996a-41b7-9dff-e3aa40c9d3a0", "username": "silverwolf267", "password": "qwer", "salt": "8WPDjsZj", "md5": "e1ba086064abd762d38662dd0b16b023", "sha1": "2acdd3a70286760c9129e51b7e5d4e7e79caed19", "sha256": "6c87ac97d86661f57c9d19892e01f907daf4aefd33d2a0265d36a713529f5c10" }, "dob": { "date": "1963-02-09T17:45:44.722Z", "age": 58 }, "registered": { "date": "2003-01-11T17:32:09.094Z", "age": 18 }, "phone": "01-7533-8041", "cell": "0497-391-989", "id": { "name": "TFN", "value": "290673742" }, "picture": { "large": "https://randomuser.me/api/portraits/women/64.jpg", "medium": "https://randomuser.me/api/portraits/med/women/64.jpg", "thumbnail": "https://randomuser.me/api/portraits/thumb/women/64.jpg" }, "nat": "AU" }], "info": { "seed": "b98f17e5a1db3c2a", "results": 10, "page": 1, "version": "1.3" } }

const workbook = new ExcelJS.Workbook();

workbook.creator = 'Me';
workbook.lastModifiedBy = 'Her';
workbook.created = new Date(1985, 8, 30);
workbook.modified = new Date();
workbook.lastPrinted = new Date(2016, 9, 27);

// Force workbook calculation on load
workbook.calcProperties.fullCalcOnLoad = true;

workbook.views = [
    {
        x: 0, y: 0, width: 10000, height: 20000,
        firstSheet: 0, activeTab: 1, visibility: 'visible'
    }
]

async function createSheet() {
    // create a sheet with red tab colour
    const worksheet = workbook.addWorksheet('My Sheet', {
        headerFooter: { firstHeader: "Hello Exceljs", firstFooter: "Hello World" }
    });

    worksheet.columns = [
        { header: 'Id', key: 'id', width: 10 },
        { header: 'Name', key: 'name', width: 32 },
        { header: 'D.O.B.', key: 'DOB', width: 10, outlineLevel: 0 }
    ];

    // Access an individual columns by key, letter and 1-based column number
    const idCol = worksheet.getColumn('id');
    const nameCol = worksheet.getColumn('B');
    const dobCol = worksheet.getColumn(3);

    // set column properties

    // Note: will overwrite cell value C1
    dobCol.header = 'Date of Birth';

    // Note: this will overwrite cell values C1:C2
    dobCol.header = ['Date of Birth', 'A.K.A. D.O.B.'];

    // from this point on, this column will be indexed by 'dob' and not 'DOB'
    dobCol.key = 'dob';

    dobCol.width = 15;

    worksheet.addRow({ id: 1, name: 'John Doe', dob: new Date(1970, 1, 1) });
    worksheet.addRow({ id: 2, name: 'Jane Doe', dob: new Date(1965, 1, 7) });
    worksheet.addRow([3, 'Sam', new Date()]);

    const rowValues = [];
    rowValues[1] = 4;
    rowValues[5] = 'Kyle';
    rowValues[9] = new Date();
    worksheet.addRow(rowValues);


    const buf = await workbook.xlsx.writeBuffer();

    saveAs(new Blob([buf]), `test.xlsx`);
}

createSheet()